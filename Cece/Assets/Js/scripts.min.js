/**
 * Cece
 * (c) 2018, Daniel James
 * 
 * Core JavaScript Functions
 * 
 * @package Cece
 */
$(document).ready(function() {

	/**
	 * Delete button confirmation.
	 */
	$('.js-delete-warn').on('click', function(e) {
		if ( ! confirm( 'Are you sure you want to delete this?' ) ) {
			e.preventDefault();
		}
	});

	/**
	 * Toggle password input type.
	 */
	$('.show-hide-pass').on('click', function(e) {
		e.preventDefault();
		var password = $(this).closest('fieldset').find('input#password');
		var showPass = $(this).attr('data-show');
		var hidePass = $(this).attr('data-hide');
		if ( 'password' == password.attr('type') ) {
			password.attr('type', 'text');
			$(this).text( hidePass );
		} else {
			password.attr('type', 'password');
			$(this).text( showPass );
		}
	});

	$('.show-hide-pass').on('keypress', function(e) {
		e.preventDefault();
		if ( 13 == e.which ) {
			var password = $(this).closest('fieldset').find('input#password');
			var showPass = $(this).attr('data-show');
			var hidePass = $(this).attr('data-hide');
			if ( 'password' == password.attr('type') ) {
				password.attr('type', 'text');
				$(this).text( hidePass );
			} else {
				password.attr('type', 'password');
				$(this).text( showPass );
			}
		}
	});

	/**
	 * Dismiss a screen notice.
	 */
	$('body').on('click', '.notice__close', function(e) {
		e.preventDefault();
		$(this).closest('.notice').fadeOut();
	});

	$('body').on('keypress', '.notice__close', function(e) {
		e.preventDefault();
		if ( 13 == e.which ) {
			$(this).closest('.notice').fadeOut();
		}
	});

	/**
	 * Force values for checkboxes.
	 */
	$('form input[type="checkbox"]').each(function() {
		var checkInput = $(this).attr('data-check-input');
		if ( $(this).is(':checked') ) {
			$(this).val('on');
		} else {
			$(this).val('off');
		}
		$('#' + checkInput).val( $(this).val() );
	});

	$('form input[type="checkbox"]').change(function() {
		var checkInput = $(this).attr('data-check-input');
		if ( $(this).is(':checked') ) {
			$(this).val('on');
		} else {
			$(this).val('off');
		}
		$('#' + checkInput).val( $(this).val() );
	});

	/**
	 * Get the menu row index.
	 */
	var menuIndex = $('.menu-input-list').attr('data-row-index');

	/**
	 * Add a new menu item row.
	 */
	$('.add-menu-row').on('click', function(e) {
		e.preventDefault();
		menuIndex++;
		var menuList = $(this).closest('fieldset').find('.menu-input-list');
		menuList.append('<li><div class="inputs"><input type="text" name="item[' + menuIndex + '][name]" id="item" placeholder="Text" required="required" /><input type="url" name="item[' + menuIndex + '][href]" id="item" placeholder="https://" required="required" /></div><div class="remove"><a class="remove-menu-row" role="link" tabindex="0"><i class="fas fa-trash-alt"></i></a></div></li>');
	});

	$('.add-menu-row').on('keypress', function(e) {
		e.preventDefault();
		if ( 13 == e.which ) {
			menuIndex++;
			var menuList = $(this).closest('fieldset').find('.menu-input-list');
			menuList.append('<li><div class="inputs"><input type="text" name="item[' + menuIndex + '][name]" id="item" placeholder="Text" required="required" /><input type="url" name="item[' + menuIndex + '][href]" id="item" placeholder="https://" required="required" /></div><div class="remove"><a class="remove-menu-row" role="link" tabindex="0"><i class="fas fa-trash-alt"></i></a></div></li>');
		}
	});

	/**
	 * Remove a menu item row.
	 */
	$('body').on('click', '.remove-menu-row', function(e) {
		e.preventDefault();
		var parentRow = $(this).closest('li');
		parentRow.remove();
	});

	$('body').on('keypress', '.remove-menu-row', function(e) {
		e.preventDefault();
		if ( 13 == e.which ) {
			var parentRow = $(this).closest('li');
			parentRow.remove();
		}
	});

	/**
	 * Dashboard mobile menu toggle.
	 */
	$('body').on('click', '.header-toggle', function(e) {
		e.preventDefault();
		$('body').toggleClass('header-open');
		$('menu.header').toggleClass('open');
	});

});

